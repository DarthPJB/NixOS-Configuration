{"path": "server_services/klipper.nix", "purpose": "Configures Klipper 3D printer firmware service with Moonraker API server and Fluidd web interface for remote monitoring and control of a 3D printer.", "key_options": ["services.prometheus.exporters.klipper", "services.klipper", "services.moonraker", "services.fluidd", "users.users.klipper", "users.users.moonraker", "networking.firewall"], "imports": [], "exports": ["Klipper firmware configuration for SKR-E3 board with TMC2209 steppers", "Moonraker API settings with CORS and trusted clients", "Fluidd web interface on print-controller.johnbargman.net", "System users and groups for Klipper and Moonraker services", "Firewall rules for service ports"], "dependencies": [], "nixos_patterns": ["services.enable for activating services", "services.settings for declarative configuration", "users.users for service accounts", "networking.firewall.allowedTCPPorts for port access"], "integration_points": ["Prometheus exporter for Klipper metrics on wireg0 interface", "Moonraker API accessible on 10.88.127.30:7125 with CORS for johnbargman.net", "Fluidd nginx configuration for web access", "LDAP password secret for nginx authentication (TODO)", "Systemd tmpfiles for Moonraker directories"], "notes": "This module sets up a complete 3D printing stack. Klipper firmware is configured for a Cartesian printer with TMC2209 stepper drivers on X, Y, Z, and extruder axes, EPCOS thermistor for hotend (max 290C), ATC Semitec for bed (max 130C), BLTouch probe with z-offset 1.925mm, bed mesh probing (15x15 to 200x220mm), and ST7920 LCD display. Moonraker provides REST API with system control enabled, trusted from local networks. Fluidd offers web UI with nginx reverse proxy. Services run under dedicated users with appropriate permissions. Ports 80 (Fluidd) and 7125 (Moonraker) are open on firewall. TODO items include prometheus exporter flags and LDAP authentication for nginx. Firmware config references skr-e3.cfg but is disabled in favor of settings block. This configuration is tailored for a specific printer hardware setup integrated into the home network. Reasoning: The detailed hardware-specific settings indicate this is for a production 3D printer in the lab, with monitoring and remote access features for operational convenience."}