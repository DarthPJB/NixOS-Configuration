{"path": "environments/sshd.nix", "purpose": "Configures OpenSSH daemon with security hardening, socket-based activation, and aggressive restart policies for reliable remote access.", "key_options": ["systemd.sockets.sshd", "services.openssh", "networking.firewall.allowedTCPPorts"], "imports": [], "exports": ["OpenSSH settings for secure authentication and connection limits", "Systemd socket configuration for automatic restarts", "Firewall rules for SSH port"], "dependencies": [], "nixos_patterns": ["services.openssh.settings for daemon configuration", "systemd.sockets for socket activation", "networking.firewall for port access"], "integration_points": ["Socket activation after wireguard-wireg0.target for VPN-dependent startup", "Aggressive restart policy (always restart after 60s) to ensure SSH availability", "Firewall allows TCP port 1108 for SSH connections"], "notes": "This module hardens SSH for security and reliability. OpenSSH runs on port 1108 (non-standard), disables root login, password authentication, X11 forwarding, and TCP forwarding. Limits login grace time to 30s, max auth tries to 3, max sessions to 2, and allows only user John88. Client alive checks prevent stale connections. Host key is ed25519. Systemd socket ensures SSH restarts on any exit, with upheld by sockets.target for persistent availability. Comments emphasize the critical nature of SSH access. This setup prioritizes security and uptime for remote administration. Reasoning: The configuration reflects a balance between security best practices (no passwords, limited access) and reliability (socket restarts), suitable for a network where SSH is essential for management but must be protected against unauthorized access."}